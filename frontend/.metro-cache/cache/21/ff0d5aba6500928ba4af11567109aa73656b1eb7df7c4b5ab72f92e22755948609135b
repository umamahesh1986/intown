{"dependencies":[{"name":"./ExpoLocation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"n9eQB3huKj/lRnIsgaXRKPJKjaY=","exportNames":["*"],"imports":1}},{"name":"./LocationEventEmitter","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":62,"index":105}}],"key":"38XLRnQdDBx35ZID4eB8duhAnLg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"LocationSubscriber\", {\n    enumerable: true,\n    get: function () {\n      return LocationSubscriber;\n    }\n  });\n  Object.defineProperty(exports, \"HeadingSubscriber\", {\n    enumerable: true,\n    get: function () {\n      return HeadingSubscriber;\n    }\n  });\n  Object.defineProperty(exports, \"LocationErrorSubscriber\", {\n    enumerable: true,\n    get: function () {\n      return LocationErrorSubscriber;\n    }\n  });\n  exports._getCurrentWatchId = _getCurrentWatchId;\n  var _ExpoLocation = require(_dependencyMap[0], \"./ExpoLocation\");\n  var ExpoLocation = _interopDefault(_ExpoLocation);\n  var _LocationEventEmitter = require(_dependencyMap[1], \"./LocationEventEmitter\");\n  let nextWatchId = 0;\n  class Subscriber {\n    callbacks = {};\n    eventSubscription = null;\n    constructor(eventName, eventDataField) {\n      this.eventName = eventName;\n      this.eventDataField = eventDataField;\n    }\n    maybeInitializeSubscription() {\n      if (this.eventSubscription) {\n        return;\n      }\n      this.eventSubscription = _LocationEventEmitter.LocationEventEmitter.addListener(this.eventName, event => this.trigger(event));\n    }\n    /**\n     * Registers given callback under new id which is then returned.\n     */\n    registerCallback(callback) {\n      this.maybeInitializeSubscription();\n      const id = ++nextWatchId;\n      this.callbacks[id] = callback;\n      return id;\n    }\n    /**\n     * Registers given callback under and existing id. This can be used to\n     * create a subscriber for the error event on the same id as the location\n     * event is subscribed to.\n     */\n    registerCallbackForId(watchId, callback) {\n      this.maybeInitializeSubscription();\n      const id = watchId;\n      this.callbacks[id] = callback;\n      return id;\n    }\n    /**\n     * Unregisters a callback with given id and revokes the subscription if possible.\n     */\n    unregisterCallback(id) {\n      // Do nothing if we have already unregistered the callback.\n      if (!this.callbacks[id]) {\n        return;\n      }\n      delete this.callbacks[id];\n      ExpoLocation.default.removeWatchAsync(id);\n      if (Object.keys(this.callbacks).length === 0 && this.eventSubscription) {\n        _LocationEventEmitter.LocationEventEmitter.removeSubscription(this.eventSubscription);\n        this.eventSubscription = null;\n      }\n    }\n    trigger(event) {\n      const watchId = event.watchId;\n      const callback = this.callbacks[watchId];\n      if (callback) {\n        callback(event[this.eventDataField]);\n      } else {\n        ExpoLocation.default.removeWatchAsync(watchId);\n      }\n    }\n  }\n  const LocationSubscriber = new Subscriber('Expo.locationChanged', 'location');\n  const HeadingSubscriber = new Subscriber('Expo.headingChanged', 'heading');\n  const LocationErrorSubscriber = new Subscriber('Expo.locationError', 'reason');\n  /**\n   * @private Necessary for some unit tests.\n   */\n  function _getCurrentWatchId() {\n    return nextWatchId;\n  }\n});","lineCount":102,"map":[[12,2,65,0,"Object"],[12,8,65,0],[12,9,65,0,"defineProperty"],[12,23,65,0],[12,24,65,0,"exports"],[12,31,65,0],[13,4,65,0,"enumerable"],[13,14,65,0],[14,4,65,0,"get"],[14,7,65,0],[14,18,65,0,"get"],[14,19,65,0],[15,6,65,0],[15,13,65,0,"LocationSubscriber"],[15,31,65,0],[16,4,65,0],[17,2,65,0],[18,2,66,0,"Object"],[18,8,66,0],[18,9,66,0,"defineProperty"],[18,23,66,0],[18,24,66,0,"exports"],[18,31,66,0],[19,4,66,0,"enumerable"],[19,14,66,0],[20,4,66,0,"get"],[20,7,66,0],[20,18,66,0,"get"],[20,19,66,0],[21,6,66,0],[21,13,66,0,"HeadingSubscriber"],[21,30,66,0],[22,4,66,0],[23,2,66,0],[24,2,67,0,"Object"],[24,8,67,0],[24,9,67,0,"defineProperty"],[24,23,67,0],[24,24,67,0,"exports"],[24,31,67,0],[25,4,67,0,"enumerable"],[25,14,67,0],[26,4,67,0,"get"],[26,7,67,0],[26,18,67,0,"get"],[26,19,67,0],[27,6,67,0],[27,13,67,0,"LocationErrorSubscriber"],[27,36,67,0],[28,4,67,0],[29,2,67,0],[30,2,71,0,"exports"],[30,9,71,0],[30,10,71,0,"_getCurrentWatchId"],[30,28,71,0],[30,31,71,0,"_getCurrentWatchId"],[30,49,71,0],[31,2,1,0],[31,6,1,0,"_ExpoLocation"],[31,19,1,0],[31,22,1,0,"require"],[31,29,1,0],[31,30,1,0,"_dependencyMap"],[31,44,1,0],[32,2,1,0],[32,6,1,0,"ExpoLocation"],[32,18,1,0],[32,21,1,0,"_interopDefault"],[32,36,1,0],[32,37,1,0,"_ExpoLocation"],[32,50,1,0],[33,2,2,0],[33,6,2,0,"_LocationEventEmitter"],[33,27,2,0],[33,30,2,0,"require"],[33,37,2,0],[33,38,2,0,"_dependencyMap"],[33,52,2,0],[34,2,3,0],[34,6,3,4,"nextWatchId"],[34,17,3,15],[34,20,3,18],[34,21,3,19],[35,2,4,0],[35,8,4,6,"Subscriber"],[35,18,4,16],[35,19,4,17],[36,4,7,4,"callbacks"],[36,13,7,13],[36,16,7,16],[36,17,7,17],[36,18,7,18],[37,4,8,4,"eventSubscription"],[37,21,8,21],[37,24,8,24],[37,28,8,28],[38,4,9,4,"constructor"],[38,15,9,15,"constructor"],[38,16,9,16,"eventName"],[38,25,9,25],[38,27,9,27,"eventDataField"],[38,41,9,41],[38,43,9,43],[39,6,10,8],[39,10,10,12],[39,11,10,13,"eventName"],[39,20,10,22],[39,23,10,25,"eventName"],[39,32,10,34],[40,6,11,8],[40,10,11,12],[40,11,11,13,"eventDataField"],[40,25,11,27],[40,28,11,30,"eventDataField"],[40,42,11,44],[41,4,12,4],[42,4,13,4,"maybeInitializeSubscription"],[42,31,13,31,"maybeInitializeSubscription"],[42,32,13,31],[42,34,13,34],[43,6,14,8],[43,10,14,12],[43,14,14,16],[43,15,14,17,"eventSubscription"],[43,32,14,34],[43,34,14,36],[44,8,15,12],[45,6,16,8],[46,6,17,8],[46,10,17,12],[46,11,17,13,"eventSubscription"],[46,28,17,30],[46,31,17,33,"LocationEventEmitter"],[46,52,17,53],[46,53,17,53,"LocationEventEmitter"],[46,73,17,53],[46,74,17,54,"addListener"],[46,85,17,65],[46,86,17,66],[46,90,17,70],[46,91,17,71,"eventName"],[46,100,17,80],[46,102,17,83,"event"],[46,107,17,88],[46,111,17,93],[46,115,17,97],[46,116,17,98,"trigger"],[46,123,17,105],[46,124,17,106,"event"],[46,129,17,111],[46,130,17,112],[46,131,17,113],[47,4,18,4],[48,4,19,4],[49,0,20,0],[50,0,21,0],[51,4,22,4,"registerCallback"],[51,20,22,20,"registerCallback"],[51,21,22,21,"callback"],[51,29,22,29],[51,31,22,31],[52,6,23,8],[52,10,23,12],[52,11,23,13,"maybeInitializeSubscription"],[52,38,23,40],[52,39,23,41],[52,40,23,42],[53,6,24,8],[53,12,24,14,"id"],[53,14,24,16],[53,17,24,19],[53,19,24,21,"nextWatchId"],[53,30,24,32],[54,6,25,8],[54,10,25,12],[54,11,25,13,"callbacks"],[54,20,25,22],[54,21,25,23,"id"],[54,23,25,25],[54,24,25,26],[54,27,25,29,"callback"],[54,35,25,37],[55,6,26,8],[55,13,26,15,"id"],[55,15,26,17],[56,4,27,4],[57,4,28,4],[58,0,29,0],[59,0,30,0],[60,0,31,0],[61,0,32,0],[62,4,33,4,"registerCallbackForId"],[62,25,33,25,"registerCallbackForId"],[62,26,33,26,"watchId"],[62,33,33,33],[62,35,33,35,"callback"],[62,43,33,43],[62,45,33,45],[63,6,34,8],[63,10,34,12],[63,11,34,13,"maybeInitializeSubscription"],[63,38,34,40],[63,39,34,41],[63,40,34,42],[64,6,35,8],[64,12,35,14,"id"],[64,14,35,16],[64,17,35,19,"watchId"],[64,24,35,26],[65,6,36,8],[65,10,36,12],[65,11,36,13,"callbacks"],[65,20,36,22],[65,21,36,23,"id"],[65,23,36,25],[65,24,36,26],[65,27,36,29,"callback"],[65,35,36,37],[66,6,37,8],[66,13,37,15,"id"],[66,15,37,17],[67,4,38,4],[68,4,39,4],[69,0,40,0],[70,0,41,0],[71,4,42,4,"unregisterCallback"],[71,22,42,22,"unregisterCallback"],[71,23,42,23,"id"],[71,25,42,25],[71,27,42,27],[72,6,43,8],[73,6,44,8],[73,10,44,12],[73,11,44,13],[73,15,44,17],[73,16,44,18,"callbacks"],[73,25,44,27],[73,26,44,28,"id"],[73,28,44,30],[73,29,44,31],[73,31,44,33],[74,8,45,12],[75,6,46,8],[76,6,47,8],[76,13,47,15],[76,17,47,19],[76,18,47,20,"callbacks"],[76,27,47,29],[76,28,47,30,"id"],[76,30,47,32],[76,31,47,33],[77,6,48,8,"ExpoLocation"],[77,18,48,20],[77,19,48,20,"default"],[77,26,48,20],[77,27,48,21,"removeWatchAsync"],[77,43,48,37],[77,44,48,38,"id"],[77,46,48,40],[77,47,48,41],[78,6,49,8],[78,10,49,12,"Object"],[78,16,49,18],[78,17,49,19,"keys"],[78,21,49,23],[78,22,49,24],[78,26,49,28],[78,27,49,29,"callbacks"],[78,36,49,38],[78,37,49,39],[78,38,49,40,"length"],[78,44,49,46],[78,49,49,51],[78,50,49,52],[78,54,49,56],[78,58,49,60],[78,59,49,61,"eventSubscription"],[78,76,49,78],[78,78,49,80],[79,8,50,12,"LocationEventEmitter"],[79,29,50,32],[79,30,50,32,"LocationEventEmitter"],[79,50,50,32],[79,51,50,33,"removeSubscription"],[79,69,50,51],[79,70,50,52],[79,74,50,56],[79,75,50,57,"eventSubscription"],[79,92,50,74],[79,93,50,75],[80,8,51,12],[80,12,51,16],[80,13,51,17,"eventSubscription"],[80,30,51,34],[80,33,51,37],[80,37,51,41],[81,6,52,8],[82,4,53,4],[83,4,54,4,"trigger"],[83,11,54,11,"trigger"],[83,12,54,12,"event"],[83,17,54,17],[83,19,54,19],[84,6,55,8],[84,12,55,14,"watchId"],[84,19,55,21],[84,22,55,24,"event"],[84,27,55,29],[84,28,55,30,"watchId"],[84,35,55,37],[85,6,56,8],[85,12,56,14,"callback"],[85,20,56,22],[85,23,56,25],[85,27,56,29],[85,28,56,30,"callbacks"],[85,37,56,39],[85,38,56,40,"watchId"],[85,45,56,47],[85,46,56,48],[86,6,57,8],[86,10,57,12,"callback"],[86,18,57,20],[86,20,57,22],[87,8,58,12,"callback"],[87,16,58,20],[87,17,58,21,"event"],[87,22,58,26],[87,23,58,27],[87,27,58,31],[87,28,58,32,"eventDataField"],[87,42,58,46],[87,43,58,47],[87,44,58,48],[88,6,59,8],[88,7,59,9],[88,13,60,13],[89,8,61,12,"ExpoLocation"],[89,20,61,24],[89,21,61,24,"default"],[89,28,61,24],[89,29,61,25,"removeWatchAsync"],[89,45,61,41],[89,46,61,42,"watchId"],[89,53,61,49],[89,54,61,50],[90,6,62,8],[91,4,63,4],[92,2,64,0],[93,2,65,7],[93,8,65,13,"LocationSubscriber"],[93,26,65,31],[93,29,65,34],[93,33,65,38,"Subscriber"],[93,43,65,48],[93,44,65,49],[93,66,65,71],[93,68,65,73],[93,78,65,83],[93,79,65,84],[94,2,66,7],[94,8,66,13,"HeadingSubscriber"],[94,25,66,30],[94,28,66,33],[94,32,66,37,"Subscriber"],[94,42,66,47],[94,43,66,48],[94,64,66,69],[94,66,66,71],[94,75,66,80],[94,76,66,81],[95,2,67,7],[95,8,67,13,"LocationErrorSubscriber"],[95,31,67,36],[95,34,67,39],[95,38,67,43,"Subscriber"],[95,48,67,53],[95,49,67,54],[95,69,67,74],[95,71,67,76],[95,79,67,84],[95,80,67,85],[96,2,68,0],[97,0,69,0],[98,0,70,0],[99,2,71,7],[99,11,71,16,"_getCurrentWatchId"],[99,29,71,34,"_getCurrentWatchId"],[99,30,71,34],[99,32,71,37],[100,4,72,4],[100,11,72,11,"nextWatchId"],[100,22,72,22],[101,2,73,0],[102,0,73,1],[102,3]],"functionMap":{"names":["<global>","Subscriber","Subscriber#constructor","Subscriber#maybeInitializeSubscription","LocationEventEmitter.addListener$argument_1","Subscriber#registerCallback","Subscriber#registerCallbackForId","Subscriber#unregisterCallback","Subscriber#trigger","_getCurrentWatchId"],"mappings":"AAA;ACG;ICK;KDG;IEC;kFCI,8BD;KFC;III;KJK;IKM;KLK;IMI;KNW;IOC;KPS;CDC;OSO;CTE"},"hasCjsExports":false},"type":"js/module"}]}